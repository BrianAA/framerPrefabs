{"version":3,"sources":["../src/index.ts","../src/switch.anatomy.ts","../src/switch.connect.ts","../src/switch.dom.ts","../src/switch.machine.ts"],"sourcesContent":["export { anatomy } from \"./switch.anatomy\"\nexport { connect } from \"./switch.connect\"\nexport { machine } from \"./switch.machine\"\nexport type { MachineApi as Api, CheckedChangeDetails, UserDefinedContext as Context, ElementIds } from \"./switch.types\"\n","import { createAnatomy } from \"@zag-js/anatomy\"\n\nexport const anatomy = createAnatomy(\"switch\").parts(\"root\", \"label\", \"control\", \"thumb\")\nexport const parts = anatomy.build()\n","import { dataAttr } from \"@zag-js/dom-query\"\nimport type { NormalizeProps, PropTypes } from \"@zag-js/types\"\nimport { visuallyHiddenStyle } from \"@zag-js/visually-hidden\"\nimport { parts } from \"./switch.anatomy\"\nimport { dom } from \"./switch.dom\"\nimport type { MachineApi, Send, State } from \"./switch.types\"\n\nexport function connect<T extends PropTypes>(state: State, send: Send, normalize: NormalizeProps<T>): MachineApi<T> {\n  const isDisabled = state.context.isDisabled\n  const isFocused = !isDisabled && state.context.focused\n  const isChecked = state.context.checked\n\n  const dataAttrs = {\n    \"data-active\": dataAttr(state.context.active),\n    \"data-focus\": dataAttr(isFocused),\n    \"data-hover\": dataAttr(state.context.hovered),\n    \"data-disabled\": dataAttr(isDisabled),\n    \"data-state\": state.context.checked ? \"checked\" : \"unchecked\",\n    \"data-invalid\": dataAttr(state.context.invalid),\n  }\n\n  return {\n    isChecked,\n    isDisabled,\n    isFocused,\n    setChecked(checked) {\n      send({ type: \"CHECKED.SET\", checked, isTrusted: false })\n    },\n    toggleChecked() {\n      send({ type: \"CHECKED.TOGGLE\", checked: isChecked, isTrusted: false })\n    },\n\n    rootProps: normalize.label({\n      ...parts.root.attrs,\n      ...dataAttrs,\n      dir: state.context.dir,\n      id: dom.getRootId(state.context),\n      htmlFor: dom.getHiddenInputId(state.context),\n      onPointerMove() {\n        if (isDisabled) return\n        send({ type: \"CONTEXT.SET\", context: { hovered: true } })\n      },\n      onPointerLeave() {\n        if (isDisabled) return\n        send({ type: \"CONTEXT.SET\", context: { hovered: false } })\n      },\n      onPointerDown(event) {\n        if (isDisabled) return\n        // On pointerdown, the input blurs and returns focus to the `body`,\n        // we need to prevent this.\n        if (isFocused) event.preventDefault()\n        send({ type: \"CONTEXT.SET\", context: { active: true } })\n      },\n      onPointerUp() {\n        if (isDisabled) return\n        send({ type: \"CONTEXT.SET\", context: { active: false } })\n      },\n      onClick(event) {\n        if (event.target === dom.getHiddenInputEl(state.context)) {\n          event.stopPropagation()\n        }\n      },\n    }),\n\n    labelProps: normalize.element({\n      ...parts.label.attrs,\n      ...dataAttrs,\n      dir: state.context.dir,\n      id: dom.getLabelId(state.context),\n    }),\n\n    thumbProps: normalize.element({\n      ...parts.thumb.attrs,\n      ...dataAttrs,\n      dir: state.context.dir,\n      id: dom.getThumbId(state.context),\n      \"aria-hidden\": true,\n    }),\n\n    controlProps: normalize.element({\n      ...parts.control.attrs,\n      ...dataAttrs,\n      dir: state.context.dir,\n      id: dom.getControlId(state.context),\n      \"aria-hidden\": true,\n    }),\n\n    hiddenInputProps: normalize.input({\n      id: dom.getHiddenInputId(state.context),\n      type: \"checkbox\",\n      required: state.context.required,\n      defaultChecked: isChecked,\n      disabled: isDisabled,\n      \"aria-labelledby\": dom.getLabelId(state.context),\n      \"aria-invalid\": state.context.invalid,\n      name: state.context.name,\n      form: state.context.form,\n      value: state.context.value,\n      style: visuallyHiddenStyle,\n      onChange(event) {\n        const checked = event.currentTarget.checked\n        send({ type: \"CHECKED.SET\", checked, isTrusted: true })\n      },\n      onBlur() {\n        send({ type: \"CONTEXT.SET\", context: { focused: false } })\n      },\n      onFocus() {\n        send({ type: \"CONTEXT.SET\", context: { focused: true } })\n      },\n      onKeyDown(event) {\n        if (event.key === \" \") {\n          send({ type: \"CONTEXT.SET\", context: { active: true } })\n        }\n      },\n      onKeyUp(event) {\n        if (event.key === \" \") {\n          send({ type: \"CONTEXT.SET\", context: { active: false } })\n        }\n      },\n    }),\n  }\n}\n","import { createScope } from \"@zag-js/dom-query\"\nimport type { MachineContext as Ctx } from \"./switch.types\"\n\nexport const dom = createScope({\n  getRootId: (ctx: Ctx) => ctx.ids?.root ?? `switch:${ctx.id}`,\n  getLabelId: (ctx: Ctx) => ctx.ids?.label ?? `switch:${ctx.id}:label`,\n  getThumbId: (ctx: Ctx) => ctx.ids?.thumb ?? `switch:${ctx.id}:thumb`,\n  getControlId: (ctx: Ctx) => ctx.ids?.control ?? `switch:${ctx.id}:control`,\n  getHiddenInputId: (ctx: Ctx) => ctx.ids?.input ?? `switch:${ctx.id}:input`,\n  getHiddenInputEl: (ctx: Ctx) => dom.getById<HTMLInputElement>(ctx, dom.getHiddenInputId(ctx)),\n})\n","import { createMachine, guards } from \"@zag-js/core\"\nimport { dispatchInputCheckedEvent, trackFormControl } from \"@zag-js/form-utils\"\nimport { compact, isEqual } from \"@zag-js/utils\"\nimport { dom } from \"./switch.dom\"\nimport type { MachineContext, MachineState, UserDefinedContext } from \"./switch.types\"\n\nconst { not } = guards\n\nexport function machine(userContext: UserDefinedContext) {\n  const ctx = compact(userContext)\n  return createMachine<MachineContext, MachineState>(\n    {\n      id: \"switch\",\n      initial: \"ready\",\n\n      context: {\n        checked: false,\n        label: \"switch\",\n        value: \"on\",\n        disabled: false,\n        ...ctx,\n        fieldsetDisabled: false,\n      },\n\n      computed: {\n        isDisabled: (ctx) => ctx.disabled || ctx.fieldsetDisabled,\n      },\n\n      watch: {\n        disabled: \"removeFocusIfNeeded\",\n        checked: \"syncInputElement\",\n      },\n\n      activities: [\"trackFormControlState\"],\n\n      on: {\n        \"CHECKED.TOGGLE\": [\n          {\n            guard: not(\"isTrusted\"),\n            actions: [\"toggleChecked\", \"dispatchChangeEvent\"],\n          },\n          {\n            actions: [\"toggleChecked\"],\n          },\n        ],\n        \"CHECKED.SET\": [\n          {\n            guard: not(\"isTrusted\"),\n            actions: [\"setChecked\", \"dispatchChangeEvent\"],\n          },\n          {\n            actions: [\"setChecked\"],\n          },\n        ],\n        \"CONTEXT.SET\": {\n          actions: [\"setContext\"],\n        },\n      },\n\n      states: {\n        ready: {},\n      },\n    },\n    {\n      guards: {\n        isTrusted: (_ctx, evt) => !!evt.isTrusted,\n      },\n      activities: {\n        trackFormControlState(ctx, _evt, { send, initialContext }) {\n          return trackFormControl(dom.getHiddenInputEl(ctx), {\n            onFieldsetDisabledChange(disabled) {\n              ctx.fieldsetDisabled = disabled\n            },\n            onFormReset() {\n              send({ type: \"CHECKED.SET\", checked: !!initialContext.checked, src: \"form-reset\" })\n            },\n          })\n        },\n      },\n\n      actions: {\n        setContext(ctx, evt) {\n          Object.assign(ctx, evt.context)\n        },\n        syncInputElement(ctx) {\n          const inputEl = dom.getHiddenInputEl(ctx)\n          if (!inputEl) return\n          inputEl.checked = !!ctx.checked\n        },\n        removeFocusIfNeeded(ctx) {\n          if (ctx.disabled && ctx.focused) {\n            ctx.focused = false\n          }\n        },\n        setChecked(ctx, evt) {\n          set.checked(ctx, evt.checked)\n        },\n        toggleChecked(ctx, _evt) {\n          set.checked(ctx, !ctx.checked)\n        },\n        dispatchChangeEvent(ctx) {\n          const inputEl = dom.getHiddenInputEl(ctx)\n          dispatchInputCheckedEvent(inputEl, { checked: ctx.checked })\n        },\n      },\n    },\n  )\n}\n\nconst invoke = {\n  change: (ctx: MachineContext) => {\n    ctx.onCheckedChange?.({ checked: ctx.checked })\n  },\n}\n\nconst set = {\n  checked: (ctx: MachineContext, checked: boolean) => {\n    if (isEqual(ctx.checked, checked)) return\n    ctx.checked = checked\n    invoke.change(ctx)\n  },\n}\n"],"mappings":"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","names":["import_dom_query","ctx"]}