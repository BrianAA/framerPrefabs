{"version":3,"sources":["../src/index.ts","../src/input-event.ts","../src/form.ts"],"sourcesContent":["export * from \"./input-event\"\nexport * from \"./form\"\n","interface DescriptorOptions {\n  type?: \"HTMLInputElement\" | \"HTMLTextAreaElement\" | \"HTMLSelectElement\"\n  property?: \"value\" | \"checked\"\n}\n\nconst getWindow = (el: HTMLElement) => el.ownerDocument.defaultView || window\n\nfunction getDescriptor(el: HTMLElement, options: DescriptorOptions) {\n  const { type = \"HTMLInputElement\", property = \"value\" } = options\n  const proto = getWindow(el)[type].prototype\n  return Object.getOwnPropertyDescriptor(proto, property) ?? {}\n}\n\nexport function setElementValue(el: HTMLElement, value: string, option: DescriptorOptions = {}) {\n  const descriptor = getDescriptor(el, option)\n  descriptor.set?.call(el, value)\n}\n\nexport function setElementChecked(el: HTMLElement, checked: boolean) {\n  const descriptor = getDescriptor(el, { type: \"HTMLInputElement\", property: \"checked\" })\n  descriptor.set?.call(el, checked)\n}\n\nexport type InputEventOptions = {\n  value: string | number\n  bubbles?: boolean\n}\n\nexport function dispatchInputValueEvent(el: HTMLElement | null, options: InputEventOptions) {\n  const { value, bubbles = true } = options\n\n  if (!el) return\n\n  const win = getWindow(el)\n  if (!(el instanceof win.HTMLInputElement)) return\n\n  setElementValue(el, `${value}`)\n  el.dispatchEvent(new win.Event(\"input\", { bubbles }))\n}\n\nexport type CheckedEventOptions = {\n  checked: boolean\n  bubbles?: boolean\n}\n\nexport function dispatchInputCheckedEvent(el: HTMLElement | null, options: CheckedEventOptions) {\n  const { checked, bubbles = true } = options\n\n  if (!el) return\n\n  const win = getWindow(el)\n  if (!(el instanceof win.HTMLInputElement)) return\n\n  setElementChecked(el, checked)\n  el.dispatchEvent(new win.Event(\"click\", { bubbles }))\n\n  // TODO: Do we really need this extra event?\n  el.dispatchEvent(new win.Event(\"change\", { bubbles }))\n}\n","import { observeAttributes } from \"@zag-js/mutation-observer\"\n\nexport function getClosestForm(el: HTMLElement) {\n  if (isFormElement(el)) return el.form\n  else return el.closest(\"form\")\n}\n\nfunction isFormElement(el: HTMLElement): el is HTMLInputElement | HTMLSelectElement | HTMLTextAreaElement {\n  return el.matches(\"textarea, input, select, button\")\n}\n\nfunction trackFormReset(el: HTMLElement | null | undefined, callback: () => void) {\n  if (!el) return\n  const form = getClosestForm(el)\n  form?.addEventListener(\"reset\", callback, { passive: true })\n  return () => {\n    form?.removeEventListener(\"reset\", callback)\n  }\n}\n\nfunction trackFieldsetDisabled(el: HTMLElement | null | undefined, callback: (disabled: boolean) => void) {\n  const fieldset = el?.closest(\"fieldset\")\n  if (!fieldset) return\n  callback(fieldset.disabled)\n  return observeAttributes(fieldset, [\"disabled\"], () => callback(fieldset.disabled))\n}\n\nexport function isNativeDisabled(el: HTMLElement) {\n  return el.matches(\":disabled\")\n}\n\nexport type FormControlOptions = {\n  onFieldsetDisabledChange: (disabled: boolean) => void\n  onFormReset: () => void\n}\n\nexport function trackFormControl(el: HTMLElement | null, options: FormControlOptions) {\n  if (!el) return\n\n  const { onFieldsetDisabledChange, onFormReset } = options\n\n  const cleanups = [trackFormReset(el, onFormReset), trackFieldsetDisabled(el, onFieldsetDisabledChange)]\n\n  return () => {\n    cleanups.forEach((cleanup) => cleanup?.())\n  }\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;ACKA,IAAM,YAAY,CAAC,OAAoB,GAAG,cAAc,eAAe;AAEvE,SAAS,cAAc,IAAiB,SAA4B;AAClE,QAAM,EAAE,OAAO,oBAAoB,WAAW,QAAQ,IAAI;AAC1D,QAAM,QAAQ,UAAU,EAAE,EAAE,IAAI,EAAE;AAClC,SAAO,OAAO,yBAAyB,OAAO,QAAQ,KAAK,CAAC;AAC9D;AAEO,SAAS,gBAAgB,IAAiB,OAAe,SAA4B,CAAC,GAAG;AAC9F,QAAM,aAAa,cAAc,IAAI,MAAM;AAC3C,aAAW,KAAK,KAAK,IAAI,KAAK;AAChC;AAEO,SAAS,kBAAkB,IAAiB,SAAkB;AACnE,QAAM,aAAa,cAAc,IAAI,EAAE,MAAM,oBAAoB,UAAU,UAAU,CAAC;AACtF,aAAW,KAAK,KAAK,IAAI,OAAO;AAClC;AAOO,SAAS,wBAAwB,IAAwB,SAA4B;AAC1F,QAAM,EAAE,OAAO,UAAU,KAAK,IAAI;AAElC,MAAI,CAAC;AAAI;AAET,QAAM,MAAM,UAAU,EAAE;AACxB,MAAI,EAAE,cAAc,IAAI;AAAmB;AAE3C,kBAAgB,IAAI,GAAG,KAAK,EAAE;AAC9B,KAAG,cAAc,IAAI,IAAI,MAAM,SAAS,EAAE,QAAQ,CAAC,CAAC;AACtD;AAOO,SAAS,0BAA0B,IAAwB,SAA8B;AAC9F,QAAM,EAAE,SAAS,UAAU,KAAK,IAAI;AAEpC,MAAI,CAAC;AAAI;AAET,QAAM,MAAM,UAAU,EAAE;AACxB,MAAI,EAAE,cAAc,IAAI;AAAmB;AAE3C,oBAAkB,IAAI,OAAO;AAC7B,KAAG,cAAc,IAAI,IAAI,MAAM,SAAS,EAAE,QAAQ,CAAC,CAAC;AAGpD,KAAG,cAAc,IAAI,IAAI,MAAM,UAAU,EAAE,QAAQ,CAAC,CAAC;AACvD;;;AC1DA,+BAAkC;AAE3B,SAAS,eAAe,IAAiB;AAC9C,MAAI,cAAc,EAAE;AAAG,WAAO,GAAG;AAAA;AAC5B,WAAO,GAAG,QAAQ,MAAM;AAC/B;AAEA,SAAS,cAAc,IAAmF;AACxG,SAAO,GAAG,QAAQ,iCAAiC;AACrD;AAEA,SAAS,eAAe,IAAoC,UAAsB;AAChF,MAAI,CAAC;AAAI;AACT,QAAM,OAAO,eAAe,EAAE;AAC9B,QAAM,iBAAiB,SAAS,UAAU,EAAE,SAAS,KAAK,CAAC;AAC3D,SAAO,MAAM;AACX,UAAM,oBAAoB,SAAS,QAAQ;AAAA,EAC7C;AACF;AAEA,SAAS,sBAAsB,IAAoC,UAAuC;AACxG,QAAM,WAAW,IAAI,QAAQ,UAAU;AACvC,MAAI,CAAC;AAAU;AACf,WAAS,SAAS,QAAQ;AAC1B,aAAO,4CAAkB,UAAU,CAAC,UAAU,GAAG,MAAM,SAAS,SAAS,QAAQ,CAAC;AACpF;AAEO,SAAS,iBAAiB,IAAiB;AAChD,SAAO,GAAG,QAAQ,WAAW;AAC/B;AAOO,SAAS,iBAAiB,IAAwB,SAA6B;AACpF,MAAI,CAAC;AAAI;AAET,QAAM,EAAE,0BAA0B,YAAY,IAAI;AAElD,QAAM,WAAW,CAAC,eAAe,IAAI,WAAW,GAAG,sBAAsB,IAAI,wBAAwB,CAAC;AAEtG,SAAO,MAAM;AACX,aAAS,QAAQ,CAAC,YAAY,UAAU,CAAC;AAAA,EAC3C;AACF;","names":[]}